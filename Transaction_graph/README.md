# Bitcoin Transaction Graphs

## Overview

A bitcoin address owns bitcoins by "owning" a number of input transactions. Suppose an address A owns transactions T and U. When address A transfers bitcoins to address B, then in reality A is transferring ownership of T or U (or both) to B. This "transfer" is itself a transaction, say V. If A transferred ownership of T to B, then we say that T is an input transaction of V. In other words, the bitcoins locked in transaction V were previously locked in T.

A __(bitcoin) transaction graph__ is a directed graph whose nodes represent (bitcoin) transactions. We draw an edge from node T to node V if T is an input transaction of V (as described above). It is this structure of how bitcoins are transferred that lets us back-track bitcoin flow.

The files in this directory implement functions and classes that allow us to construct such a transaction graph given blockchain data. Each file is described in more detail in the sections below.

## data_tools.py

This file implements functions that accomplish the following:
* Using the blockchain.info API to retrieve JSON data for a block with a given hash and saving the JSON data to disk.
* Using the blockchain.info API to download any number of block JSON files.
* Extracting the input transactions and their values for any given transaction.
* Calculating the probability that a bitcoin owned by one transaction came from one of its input transactions.
* Creating a CSV file that records input transaction, output transaction, input value, and backflow probability on each line.

## graph_tools.py

This file implements a class for transaction graphs. Important notes are the following:
* The class inherits methods from the DiGraph class found in the __networkx__ module.
* The class allows a transaction graph to be built from CSV data (in the form generated by data_tools.py). Each line of the CSV data defines a directed edge between an input transaction and output transaction that is weighted by two attributes-- input value and backflow probability.
* There is a method that calculates the probability that a bitcoin belonging to transaction T belonged at some point in the past to transaction U.
* Outside of the class, there are two functions that help to __pickle__ (save to disk) and __unpickle__ (load from disk) transaction graphs.

## main.py

This file is similar to __main_entire.py__ found in the __Address_graph__ directory. The only difference is that it is for transaction graphs.